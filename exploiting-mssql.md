### Exploiting MSSQL

This chapter goes into the exploitation of MSSQL and some of the tools used for this.

* sqsh
* xp\_cmdshell

* * * Instead of running xp\_cmdshell you can invoke others parts of the database to call SMB shares

Stand up responder and collect the user hash



Of course SQLMap is the tool recommended for exploiting vulenrabilities. The --os-shell parameter does magic like enabling and using xp\_cmdshell to spawn a shell on the actual operating system level. This shell might be slow so adding threads can speed it up. However, the most efficient way to get a proper shell is spawning a new one using powershell. See the [Pivoting ](/pivoting.md)article for how to execute shells straight from memory. If powershell is disabled or not available, sqlmap has modules like os-pwn and os-relay that can spawn meterpreter shells amongst others. 

`sqlmap -r r.txt --level=5 --risk=1 --os-shell --threads=10`

 https://github.com/sqlmapproject/sqlmap/wiki/Usage



